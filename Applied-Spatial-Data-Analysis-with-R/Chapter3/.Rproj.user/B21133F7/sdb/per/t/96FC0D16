{
    "contents" : "### R code from vignette source 'vis.Rnw'\n# data: \n###################################################\n### code chunk number 9: vis.Rnw:180-185 \n###################################################\nlibrary(sp)\ndata(meuse)\ncoordinates(meuse) <- c(\"x\", \"y\")\nplot(meuse)\ntitle(\"points\")\n\n\n###################################################\n### code chunk number 10: vis.Rnw:197-201 \n###################################################\ncc <- coordinates(meuse)\nm.sl <- SpatialLines(list(Lines(list(Line(cc)), \"line1\")))\nplot(m.sl)\ntitle(\"lines\")\n\n\n###################################################\n### code chunk number 11: vis.Rnw:213-218 \n###################################################\ndata(meuse.riv)\nmeuse.lst <- list(Polygons(list(Polygon(meuse.riv)), \"meuse.riv\"))\nmeuse.pol <- SpatialPolygons(meuse.lst)\nplot(meuse.pol, col = \"grey\")\ntitle(\"polygons\")\n\n\n###################################################\n### code chunk number 12: vis.Rnw:230-235 \n###################################################\ndata(meuse.grid)\ncoordinates(meuse.grid) <- c(\"x\", \"y\")\nmeuse.grid <- as(meuse.grid, \"SpatialPixels\")\nimage(meuse.grid, col = \"grey\")\ntitle(\"grid\")\n\n\n###################################################\n### code chunk number 13: vis.Rnw:266-278\n###################################################\nimage(meuse.grid, col = \"khaki2\")\nplot(meuse.pol, col = \"lightsteelblue2\", add = TRUE)\nplot(meuse, add = TRUE, col = \"brown\", cex = .5)\n\n\n###################################################\n### code chunk number 16: vis.Rnw:353-359 (eval = FALSE)\n###################################################\nlayout(matrix(c(1,2),1,2))\nplot(meuse.pol, axes = TRUE)\nplot(meuse.pol, axes = FALSE)\naxis(1, at = c(178000 + 0:2 * 2000), cex.axis = .7)\naxis(2, at = c(326000 + 0:3 * 4000), cex.axis = .7)\nbox()\n\n\n###################################################\n### code chunk number 18: vis.Rnw:426-437 (eval = FALSE)\n###################################################\noldpar = par(no.readonly = TRUE)\nlayout(matrix(c(1,2),1,2))\nplot(meuse, axes = TRUE, cex = 0.6)\nplot(meuse.pol, add = TRUE)\ntitle(\"Sample locations\")\n\npar(mar=c(0,0,0,0)+.1)\nplot(meuse, axes = FALSE, cex = 0.6)\nplot(meuse.pol, add = TRUE)\nbox()\npar(oldpar)\n\n\n###################################################\n### code chunk number 20: vis.Rnw:498-507 (eval = FALSE)\n###################################################\nplot(meuse)\nplot(meuse.pol, add=TRUE)\nplot(meuse)\nSpatialPolygonsRescale(layout.scale.bar(), offset = c(180200,329600),\n    scale = 1000, fill=c(\"transparent\",\"black\"), plot.grid = FALSE)\ntext(x = c(180200,181200), y = rep(329750, 2), c(\"0\", \"1 km\"))\nSpatialPolygonsRescale(layout.north.arrow(), offset = c(178750,332500),\n    scale = 400, plot.grid = FALSE)\n\n\n###################################################\n### code chunk number 21: vis.Rnw:537-538\n###################################################\nlibrary(maptools) # requires sp\n\n\n###################################################\n### code chunk number 22: vis.Rnw:543-567\n###################################################\nnc <- readShapePoly(system.file(\"shapes/sids.shp\", package=\"maptools\")[1],\n  proj4string=CRS(\"+proj=longlat +datum=NAD27\"))\nrrt <- nc$SID74/nc$BIR74\nbrks <- quantile(rrt, seq(0,1,1/5))\nlibrary(RColorBrewer)\ncols <- brewer.pal(5, \"Reds\")\nplot(nc, col=cols[findInterval(rrt, brks, all.inside=TRUE)], axes = FALSE)\nbox()\ndegAxis(1)\ndegAxis(2, at=34:37)\n\n\n###################################################\n### code chunk number 23: vis.Rnw:598-617 (eval = FALSE)\n###################################################\nlibrary(maptools)\nlibrary(maps)\nwrld <- map(\"world\", interior=FALSE, xlim=c(-179,179), \n   ylim=c(-89,89), plot=FALSE)\nwrld_p <- pruneMap(wrld, xlim=c(-179,179))\nllCRS <- CRS(\"+proj=longlat +ellps=WGS84\")\nwrld_sp <- map2SpatialLines(wrld_p, proj4string=llCRS)\nprj_new <- CRS(\"+proj=moll\")\nlibrary(rgdal)\nwrld_proj <- spTransform(wrld_sp, prj_new)\nwrld_grd <- gridlines(wrld_sp, easts=c(-179,seq(-150,150,50), 179.5),              norths=seq(-75,75,15), ndiscr=100)\nwrld_grd_proj <- spTransform(wrld_grd, prj_new)\nat_sp <- gridat(wrld_sp, easts=0, norths=seq(-75,75,15), offset=0.3)\nat_proj <- spTransform(at_sp, prj_new)\nplot(wrld_proj, col=\"grey60\")\nplot(wrld_grd_proj, add=TRUE, lty=3, col=\"grey70\")\ntext(coordinates(at_proj), pos=at_proj$pos, offset=at_proj$offset,                 labels=parse(text=as.character(at_proj$labels)), cex=0.6)\n\n\n###################################################\n### code chunk number 24: vis.Rnw:636-638\n###################################################\n## par(\"pin\")\n## par(pin = c(4,4))\n\n\n###################################################\n### code chunk number 25: vis.Rnw:649-651 (eval = FALSE)\n###################################################\n## dev.off()\n## X11(width = 10, height = 10)\n\n\n###################################################\n### code chunk number 26: vis.Rnw:659-660 (eval = FALSE)\n###################################################\n## pdf(\"file.pdf\", width=5, height=7)\n\n\n###################################################\n### code chunk number 27: vis.Rnw:676-682 (eval = FALSE)\n###################################################\n## pin <- par(\"pin\")\n## dxy <- apply(bbox(meuse), 1, diff)\n## ratio <- dxy[1]/dxy[2]\n## par(pin=c(ratio * pin[2], pin[2]), xaxs=\"i\", yaxs=\"i\")\n## plot(meuse, pch = 1)\n## box()\n\n\n###################################################\n### code chunk number 29: vis.Rnw:723-724 (eval = FALSE)\n###################################################\n## par(mfrow = c(2,3))\n\n\n###################################################\n### code chunk number 30: vis.Rnw:731-732 (eval = FALSE)\n###################################################\n## layout(matrix(1:6, 2, 3, byrow = TRUE))\n\n\n###################################################\n### code chunk number 31: vis.Rnw:780-785\n###################################################\ndata(meuse.grid)\ncoordinates(meuse.grid) <- c(\"x\", \"y\")\ngridded(meuse.grid) <- TRUE\nlibrary(gstat)\nzn.idw <- krige(log(zinc) ~ 1, meuse, meuse.grid)\n\n\n###################################################\n### code chunk number 32: vis.Rnw:790-814\n###################################################\nlibrary(RColorBrewer)\ncols <- brewer.pal(4, \"Reds\")\nimage(zn.idw, col = cols, breaks=log(c(100,200,400,800,1800)))\nplot(meuse.pol, add = TRUE)\nplot(meuse, pch = 1, cex = sqrt(meuse$zinc)/20, add = TRUE)\nlegVals <- c(100, 200, 500, 1000, 2000)\nlegend(\"left\", legend=legVals, pch = 1, pt.cex = sqrt(legVals)/20, bty = \"n\",\n  title=\"measured, ppm\", cex=0.8, y.inter=0.9)\nlegend(\"topleft\", fill = cols, legend=c(\"100-200\",\"200-400\",\"400-800\",\n  \"800-1800\"), bty = \"n\", title = \"interpolated, ppm\", cex=0.8, y.inter=0.9)\ntitle(\"measured and interpolated zinc\")\n\n\n###################################################\n### code chunk number 33: vis.Rnw:822-832\n###################################################\nlibrary(gstat)\nlibrary(sp)\ndata(meuse)\ncoordinates(meuse) <- ~x+y\ndata(meuse.grid)\ncoordinates(meuse.grid) <- ~x+y\ngridded(meuse.grid) <- T\nzn <- krige(zinc~1,meuse,meuse.grid)\nzn$direct <- zn$var1.pred\nzn$log <- exp(krige(log(zinc)~1,meuse,meuse.grid)$var1.pred)\n\n\n###################################################\n### code chunk number 34: vis.Rnw:837-853\n###################################################\nlibrary(lattice)\nprint(levelplot(z~x+y|name, spmap.to.lev(zn[c(\"direct\", \"log\")]), asp = \"iso\",\n        cuts=4, col.regions= brewer.pal(5, \"Reds\")),\n    split = c(1,1,1,2), more = TRUE)\nprint(spplot(zn[c(\"direct\", \"log\")], cuts=4,\n        col.regions= brewer.pal(5, \"Reds\")),\n\t\tsplit = c(1,2,1,2))\n\n\n###################################################\n### code chunk number 38: vis.Rnw:997-1014\n###################################################\ncuts=c(0,20,50,200,500,2000)\ngrys <- brewer.pal(7, \"Reds\")\nprint(spplot(meuse[1:4], main = \"ppm\", cuts=cuts, cex=.5, col.regions=grys, key.space=\"right\"),\n      split=c(1,1,1,2),more=TRUE)\nmeuse$lead.st = as.vector(scale(meuse$lead))\nmeuse$zinc.st = as.vector(scale(meuse$zinc))\nmeuse$copper.st = as.vector(scale(meuse$copper))\nmeuse$cadmium.st = as.vector(scale(meuse$cadmium))\ncuts=c(-1.2,0,1,2,3,5)\nprint(spplot(meuse, c(\"cadmium.st\", \"copper.st\", \"lead.st\", \"zinc.st\"), key.space=\"right\", main = \"standardised\", cex = .5, cuts = cuts, col.regions=grys),\n        split=c(1,2,1,2))\n\n\n###################################################\n### code chunk number 39: vis.Rnw:1025-1051\n###################################################\ngrys <- brewer.pal(9, \"Reds\")\ndata(meuse.grid)\ncoordinates(meuse.grid) <- c(\"x\", \"y\")\nmeuse.grid <- as(meuse.grid, \"SpatialPixelsDataFrame\")\ncl = ContourLines2SLDF(contourLines(as.image.SpatialGridDataFrame(\n  meuse.grid[\"dist\"])))\nprint(spplot(cl, colorkey=list(height=0.8, width=0.6), col.regions=grys), \n  split = c(1,1,3,1), more=TRUE)\ngrys <- brewer.pal(6, \"Reds\")\ncuts = (0:5)/5\nprint(spplot(meuse.grid, \"dist\", at=cuts\n, colorkey=list(labels=list(at=cuts), at=cuts), col.regions=grys)\n, split = c(2,1,3,1), more = TRUE)\nmeuse.grid$f = factor(meuse.grid$ffreq, labels = c(\"annual\", \"2-5 yrs\", \n  \"> 5 yrs\"))\nprint(spplot(meuse.grid, \"f\", colorkey=list(height=0.4, width=0.6), \n  col.regions= brewer.pal(3, \"Reds\")), split = c(3,1,3,1), more=FALSE)\n\n\n###################################################\n### code chunk number 40: vis.Rnw:1098-1105 \n###################################################\nlibrary(maptools)\ndata(meuse.grid)\ncoordinates(meuse.grid) <- c(\"x\", \"y\")\nmeuse.grid <- as(meuse.grid, \"SpatialPixelsDataFrame\")\nim <- as.image.SpatialGridDataFrame(meuse.grid[\"dist\"])\ncl <- ContourLines2SLDF(contourLines(im))\nspplot(cl)\n\n\n###################################################\n### code chunk number 41: vis.Rnw:1151-1161\n###################################################\nriver <- list(\"sp.polygons\", meuse.pol)\nnorth <- list(\"SpatialPolygonsRescale\", layout.north.arrow(), offset = \n  c(178750,332500),\n    scale = 400)\nscale <- list(\"SpatialPolygonsRescale\", layout.scale.bar(), offset = \n  c(180200, 329800), scale = 1000, fill=c(\"transparent\",\"black\"))\ntxt1 <- list(\"sp.text\", c(180200, 329950), \"0\")\ntxt2 <- list(\"sp.text\", c(181200, 329950), \"1 km\")\npts <- list(\"sp.points\", meuse, pch = 3, col = \"black\")\nmeuse.layout <- list(river, north, scale, txt1, txt2, pts)\n\n\n###################################################\n### code chunk number 43: vis.Rnw:1170-1179\n###################################################\ngrys <- brewer.pal(7, \"Reds\")\nprint(spplot(zn[\"log\"], sp.layout = meuse.layout, cuts=5, col.regions=grys))\n\n\n###################################################\n### code chunk number 45: vis.Rnw:1272-1274 (eval = FALSE)\n###################################################\nlibrary(ggplot2)\nmethods(fortify)\n\n\n###################################################\n### code chunk number 46: vis.Rnw:1287-1289 (eval = FALSE)\n###################################################\nm = as(meuse, \"data.frame\")\nggplot(m, aes(x,y)) + geom_point() + coord_equal()\n\n\n###################################################\n### code chunk number 48: vis.Rnw:1344-1356\n###################################################\nlibrary(latticeExtra)\nreds <- brewer.pal(7, \"Reds\")\np = spplot(meuse[\"zinc\"], cuts = 5, col.regions = reds)\nm = SpatialPolygonsDataFrame(meuse.pol, data.frame(col=1), match.ID = FALSE)\nl = spplot(m, cuts = 5, col.regions = reds)\nprint(l + p, more = TRUE, split = c(1,1,2,1))\nprint(p + l, split = c(2,1,2,1))\n\n\n###################################################\n### code chunk number 49: vis.Rnw:1391-1393 (eval = FALSE)\n###################################################\n## plot(meuse)\n## meuse.id <- identify(coordinates(meuse))\n\n\n###################################################\n### code chunk number 50: vis.Rnw:1403-1410 (eval = FALSE)\n###################################################\n## plot(meuse)\n## region <- locator(type=\"o\")\n## n <- length(region$x)\n## p <- Polygon(cbind(region$x,region$y)[c(1:n,1),], hole=FALSE)\n## ps <- Polygons(list(p), ID = \"region\")\n## sps <- SpatialPolygons(list(ps))\n## plot(meuse[sps,], pch=16, cex=.5, add=TRUE)\n\n\n###################################################\n### code chunk number 52: vis.Rnw:1471-1475\n###################################################\nlibrary(maptools)\nprj <- CRS(\"+proj=longlat +datum=NAD27\")\nnc_shp <- system.file(\"shapes/sids.shp\", package=\"maptools\")[1]\nnc <- readShapePoly(nc_shp, proj4string=prj)\n\n\n###################################################\n### code chunk number 53: vis.Rnw:1477-1479 (eval = FALSE)\n###################################################\n## plot(nc)\n## pt <- locator(type=\"p\")\n\n\n###################################################\n### code chunk number 54: vis.Rnw:1481-1484\n###################################################\n## print(pt)\n## pt.sp = SpatialPoints(cbind(pt$x,pt$y),proj4string=prj)\n## over(pt.sp, nc)\n\n\n###################################################\n### code chunk number 55: vis.Rnw:1500-1501 (eval = FALSE)\n###################################################\n## ids <- spplot(meuse, \"zinc\", identify=TRUE)\n\n\n###################################################\n### code chunk number 56: vis.Rnw:1515-1519 (eval = FALSE)\n###################################################\n## library(lattice)\n## trellis.focus(\"panel\", column = 1, row = 1)\n## ids <- panel.identify()\n## trellis.unfocus()\n\n\n###################################################\n### code chunk number 57: vis.Rnw:1529-1533 (eval = FALSE)\n###################################################\n## library(grid)\n## trellis.focus(\"panel\", column = 1, row = 1)\n## as.numeric(grid.locator())\n## trellis.unfocus()\n\n\n###################################################\n### code chunk number 58: vis.Rnw:1575-1577 \n###################################################\nrw.colors <- colorRampPalette(c(\"red\", \"white\"))\nimage(meuse.grid[\"dist\"], col=rw.colors(10))\n\n\n###################################################\n### code chunk number 59: vis.Rnw:1594-1596 (eval = FALSE)\n###################################################\n## library(RColorBrewer)\n## example(brewer.pal)\n\n\n###################################################\n### code chunk number 60: vis.Rnw:1648-1658\n###################################################\nlibrary(RColorBrewer)\nlibrary(classInt)\npal <- brewer.pal(5, \"Reds\")\nq5 <- classIntervals(meuse$zinc, n=5, style=\"quantile\")\nq5\ndiff(q5$brks)\n\n\n###################################################\n### code chunk number 61: vis.Rnw:1660-1661 (eval = FALSE)\n###################################################\nplot(q5, pal=pal)\n\n\n###################################################\n### code chunk number 62: vis.Rnw:1688-1691\n###################################################\nfj5 <- classIntervals(meuse$zinc, n=5, style=\"fisher\")\nfj5\ndiff(fj5$brks)\n\n\n###################################################\n### code chunk number 63: vis.Rnw:1692-1693 (eval = FALSE)\n###################################################\nplot(fj5, pal=pal)\n\n\n###################################################\n### code chunk number 65: vis.Rnw:1722-1745\n###################################################\noopar <- par(mar=c(1,1,3,1)+0.1, mfrow=c(1,2))\nq5Colours <- findColours(q5, pal)\nplot(meuse, col=q5Colours, pch=19)\npoints(meuse, pch=1)\nbox()\ntitle(main=\"Quantile\")\nlegend(\"topleft\", fill=attr(q5Colours, \"palette\"), legend=names(attr(q5Colours,\n  \"table\")), bty=\"n\", cex=0.8, y.intersp=0.8)\nfj5Colours <- findColours(fj5, pal)\nplot(meuse, col=fj5Colours, pch=19)\npoints(meuse, pch=1)\nbox()\ntitle(main=\"Fisher-Jenks\")\nlegend(\"topleft\", fill=attr(fj5Colours, \"palette\"),\n legend=names(attr(fj5Colours, \"table\")), bty=\"n\", cex=0.8, y.intersp=0.8)\npar(oopar)\n\n\n###################################################\n### code chunk number 66: vis.Rnw:1765-1769 (eval = FALSE)\n###################################################\nq5Colours <- findColours(q5, pal)\nplot(meuse, col=q5Colours, pch=19)\nlegend(\"topleft\", fill=attr(q5Colours, \"palette\"),\n legend=names(attr(q5Colours, \"table\")), bty=\"n\")\n\n\n###################################################\n### code chunk number 67: vis.Rnw:1816-1818 (eval = FALSE)\n###################################################\ncuts = (0:10)/10\nspplot(meuse.grid, \"dist\", colorkey=list(labels=list(at=cuts)), at=cuts)\n\n\n",
    "created" : 1391966736675.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "664037777",
    "id" : "96FC0D16",
    "lastKnownWriteTime" : 1372024716,
    "path" : "D:/Dropbox/Research/Codes/R/SpatialData/Chapter3/vis_mod.R",
    "project_path" : "vis_mod.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}